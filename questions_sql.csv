question,perfect_sql
"What are all of my accounts?","SELECT account_holder_name, iban, source_bank FROM unified_accounts;"
"What is my current total balance across all my accounts?","SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT account_id_fk, MAX(timestamp) AS max_timestamp FROM unified_balances GROUP BY account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;"
"Show me my last 5 expenses","SELECT booking_date, description, amount FROM unified_transactions WHERE amount < 0 ORDER BY booking_date DESC, transaction_pk DESC LIMIT 5;"
"How much did I spend in total last month?","SELECT SUM(amount) as total_spending FROM unified_transactions WHERE booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') AND amount < 0;"
"What was my single biggest expense this month?","SELECT description, amount, booking_date FROM unified_transactions WHERE booking_date >= date('now', 'start of month') AND amount < 0 ORDER BY amount ASC LIMIT 1;"
"List all my transactions from Albert Heijn","SELECT booking_date, description, amount FROM unified_transactions WHERE description LIKE '%Albert Heijn%' ORDER BY booking_date DESC;"
"What income have I received this month?","SELECT booking_date, description, amount FROM unified_transactions WHERE amount > 0 AND booking_date >= date('now', 'start of month') ORDER BY booking_date DESC;"
"How many times did I go to a restaurant last month?","SELECT COUNT(*) as visit_count FROM unified_transactions WHERE (description LIKE '%restaurant%' OR description LIKE '%eetcafe%') AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day');"
"What's the current balance of my ING account?","SELECT b.amount FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ING' ORDER BY b.timestamp DESC LIMIT 1;"
"Did I spend more on dining out this month or last month?","SELECT 'last_month' as period, SUM(amount) as total FROM unified_transactions WHERE (description LIKE '%restaurant%' OR description LIKE '%eetcafe%') AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') AND amount < 0 UNION ALL SELECT 'this_month' as period, SUM(amount) as total FROM unified_transactions WHERE (description LIKE '%restaurant%' OR description LIKE '%eetcafe%') AND booking_date >= date('now', 'start of month') AND amount < 0;"
"Show me my spending from the first week of May 2025.","SELECT description, amount FROM unified_transactions WHERE booking_date BETWEEN '2025-05-01' AND '2025-05-07' AND amount < 0 ORDER BY booking_date;"
"What were my expenses on weekends this month?","SELECT booking_date, description, amount FROM unified_transactions WHERE strftime('%w', booking_date) IN ('0', '6') AND booking_date >= date('now', 'start of month') AND amount < 0;"
"Have I received my salary yet this month?","SELECT booking_date, description, amount FROM unified_transactions WHERE amount > 0 AND (description LIKE '%salary%' OR description LIKE '%salaris%') AND booking_date >= date('now', 'start of month') LIMIT 1;"
"List my transactions from after 10 PM yesterday.","SELECT execution_timestamp, description, amount FROM unified_transactions WHERE execution_timestamp >= datetime('now', '-1 day', 'start of day', '+22 hours');"
"How much money did I receive from the counterparty with IBAN NL12ABNA0123456789?","SELECT SUM(amount) as total_received FROM unified_transactions WHERE counterparty_iban = 'NL12ABNA0123456789' AND amount > 0;"
"Which 5 people or companies paid me the most money this year?","SELECT counterparty_name, SUM(amount) as total_received FROM unified_transactions WHERE amount > 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now') AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY total_received DESC LIMIT 5;"
"Show me any payments I made to someone named 'Jansen'.","SELECT booking_date, description, counterparty_name, amount FROM unified_transactions WHERE counterparty_name LIKE '%Jansen%' AND amount < 0 ORDER BY booking_date DESC;"
"What was the highest and lowest my ING account balance was this month?","SELECT MIN(b.amount) as lowest_balance, MAX(b.amount) as highest_balance FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ING' AND b.timestamp >= date('now', 'start of month');"
"Find all transactions where the description contains the word 'subscription'.","SELECT booking_date, description, amount FROM unified_transactions WHERE description LIKE '%subscription%' ORDER BY booking_date DESC;"
"List all my expenses that were larger than my average expense this month.","SELECT booking_date, description, amount FROM unified_transactions WHERE amount < 0 AND booking_date >= date('now', 'start of month') AND amount < (SELECT AVG(amount) FROM unified_transactions WHERE amount < 0 AND booking_date >= date('now', 'start of month')) ORDER BY amount ASC;"
"On which day of the week do I tend to spend the most?","SELECT CASE strftime('%w', booking_date) WHEN '0' THEN 'Sunday' WHEN '1' THEN 'Monday' WHEN '2' THEN 'Tuesday' WHEN '3' THEN 'Wednesday' WHEN '4' THEN 'Thursday' WHEN '5' THEN 'Friday' ELSE 'Saturday' END as day_of_week, SUM(amount) as total_spent FROM unified_transactions WHERE amount < 0 GROUP BY day_of_week ORDER BY total_spent ASC LIMIT 1;"
"What percentage of my income last month was spent at Albert Heijn?","SELECT (SUM(CASE WHEN description LIKE '%Albert Heijn%' OR description LIKE '%Jumbo%' THEN amount ELSE 0 END) / SUM(CASE WHEN amount > 0 THEN amount ELSE 0 END)) * -100.0 as percentage_of_income FROM unified_transactions WHERE booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day');"
"What was the very last transaction on my ABN AMRO account?","SELECT t.booking_date, t.description, t.amount FROM unified_transactions t JOIN unified_accounts a ON t.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' ORDER BY t.booking_date DESC, t.transaction_pk DESC LIMIT 1;"
"List all my bank accounts and their product names.","SELECT iban, source_bank, product_name, account_holder_name FROM unified_accounts;"
"What is the total balance of just my ABN AMRO accounts?","SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT b.account_id_fk, MAX(b.timestamp) AS max_timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' GROUP BY b.account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;"
"What was my most expensive day last month?","SELECT booking_date, SUM(amount) as daily_total FROM unified_transactions WHERE amount < 0 AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') GROUP BY booking_date ORDER BY daily_total ASC LIMIT 1;"
"Find transactions with a blank description.","SELECT booking_date, amount, counterparty_name FROM unified_transactions WHERE description IS NULL OR description = '';"
"How many unique companies did I pay money to this month?","SELECT COUNT(DISTINCT counterparty_name) as unique_payees FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' AND booking_date >= date('now', 'start of month');"
"What is the transaction type code for my salary?","SELECT type_code, description FROM unified_transactions WHERE (description LIKE '%salary%' OR description LIKE '%salaris%') AND amount > 0 LIMIT 1;"
"Show me all transactions that are not from ABN AMRO or ING.","SELECT * FROM unified_transactions WHERE source_bank NOT IN ('ABN AMRO', 'ING');"
"Did I spend anything at all on the first day of this year?","SELECT CASE WHEN EXISTS (SELECT 1 FROM unified_transactions WHERE date(booking_date) = strftime('%Y-01-01', 'now') AND amount < 0) THEN 'Yes' ELSE 'No' END as spending_exists;"
"Find my recent payments to a company, I think it was called 'Coolblue' or something like that.","SELECT booking_date, description, amount FROM unified_transactions WHERE description LIKE '%coolblue%' ORDER BY booking_date DESC LIMIT 5;"
"What are the details of transaction with the id 'xyz-789'?","SELECT * FROM unified_transactions WHERE transaction_id = 'xyz-789';"
"I just got paid, what's my total balance now?","SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT account_id_fk, MAX(timestamp) AS max_timestamp FROM unified_balances GROUP BY account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;"
"What is my average monthly spending for this year so far?","SELECT SUM(amount) / CAST(strftime('%m', 'now') AS REAL) as average_monthly_spending FROM unified_transactions WHERE amount < 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now');"
"What's my biggest source of income by name?","SELECT counterparty_name, SUM(amount) as total_income FROM unified_transactions WHERE amount > 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY total_income DESC LIMIT 1;"
"List my top 3 spending categories, assuming 'Albert Heijn' or 'Jumbo' are 'Groceries' and 'Netflix' or 'Spotify' are 'Subscriptions'.","SELECT CASE WHEN description LIKE '%Albert Heijn%' OR description LIKE '%Jumbo%' THEN 'Groceries' WHEN description LIKE '%Netflix%' OR description LIKE '%Spotify%' THEN 'Subscriptions' WHEN description LIKE '%restaurant%' THEN 'Dining Out' ELSE 'Other' END as category, SUM(amount) as total_spent FROM unified_transactions WHERE amount < 0 GROUP BY category ORDER BY total_spent ASC LIMIT 3;"
"How has my income changed month-over-month this year?","SELECT strftime('%Y-%m', booking_date) as month, SUM(amount) as monthly_income FROM unified_transactions WHERE amount > 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now') GROUP BY month ORDER BY month;"
"Is my spending on transport increasing or decreasing this month compared to last?","SELECT SUM(CASE WHEN booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') THEN amount ELSE 0 END) AS last_month, SUM(CASE WHEN booking_date >= date('now', 'start of month') THEN amount ELSE 0 END) AS this_month FROM unified_transactions WHERE (description LIKE '%NS Ticket%' OR description LIKE '%Uber%') AND amount < 0;"
"What was the day with the highest number of transactions this month?","SELECT booking_date, COUNT(transaction_pk) as transaction_count FROM unified_transactions WHERE booking_date >= date('now', 'start of month') GROUP BY booking_date ORDER BY transaction_count DESC LIMIT 1;"
"Which of my accounts currently has the highest balance?","SELECT a.iban, a.source_bank, b.amount FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id JOIN (SELECT account_id_fk, MAX(timestamp) AS max_ts FROM unified_balances GROUP BY account_id_fk) latest ON b.account_id_fk = latest.account_id_fk AND b.timestamp = latest.max_ts ORDER BY b.amount DESC LIMIT 1;"
"Have there been any balance updates for any of my accounts today?","SELECT a.iban, b.amount, b.timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE date(b.timestamp) = date('now') ORDER BY b.timestamp DESC;"
"Show me the last 3 balance records for my ABN AMRO account.","SELECT b.timestamp, b.amount FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' ORDER BY b.timestamp DESC LIMIT 3;"
"List everyone that I have paid but who has never paid me.","SELECT DISTINCT counterparty_name FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' AND counterparty_name NOT IN (SELECT DISTINCT counterparty_name FROM unified_transactions WHERE amount > 0);"
"Show me my largest expense that was NOT for groceries.","SELECT description, amount, booking_date FROM unified_transactions WHERE amount < 0 AND description NOT LIKE '%Albert Heijn%' AND description NOT LIKE '%Jumbo%' ORDER BY amount ASC LIMIT 1;"
"What's the total of all transactions that have an unknown type code?","SELECT SUM(amount) FROM unified_transactions WHERE type_code IS NULL OR type_code = '';"
"Do I have any bank accounts that are not from the Netherlands?","SELECT * FROM unified_accounts WHERE iban NOT LIKE 'NL%';"
"How many days have passed between my very first and very last transaction?","SELECT julianday(MAX(booking_date)) - julianday(MIN(booking_date)) as days_between FROM unified_transactions;"
"Give me my total spending this month, but exclude all payments to Bol.com.","SELECT SUM(amount) FROM unified_transactions WHERE amount < 0 AND booking_date >= date('now', 'start of month') AND description NOT LIKE '%Bol.com%';"
"What is the average balance of my ABN AMRO accounts?","SELECT AVG(t1.amount)	FROM unified_balances t1 JOIN (SELECT b.account_id_fk, MAX(b.timestamp) AS max_timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' GROUP BY b.account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;"
"What were my total expenses in the first quarter of this year?","SELECT SUM(amount) as total_expenses FROM unified_transactions WHERE amount < 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now') AND strftime('%m', booking_date) IN ('01', '02', '03');"
"What were my expenses on weekends this month?","SELECT booking_date, description, amount FROM unified_transactions WHERE strftime('%w', booking_date) IN ('0', '6') AND booking_date >= date('now', 'start of month') AND amount < 0;"
"how much did I spend on the 15th of last month?","SELECT SUM(amount) FROM unified_transactions WHERE date(booking_date) = date('now', 'start of month', '-1 month', '+14 days') AND amount < 0;"
"Show me all transactions that happened on a Monday this year.","SELECT booking_date, description, amount FROM unified_transactions WHERE strftime('%w', booking_date) = '1' AND strftime('%Y', booking_date) = strftime('%Y', 'now');"
"What were my total expenses during the work week (Mon-Fri) versus the weekend last week?","SELECT CASE WHEN strftime('%w', booking_date) IN ('0', '6') THEN 'Weekend' ELSE 'Weekday' END as period_type, SUM(amount) as total_spent FROM unified_transactions WHERE booking_date BETWEEN date('now', 'weekday 0', '-13 days') AND date('now', 'weekday 0', '-7 days') AND amount < 0 GROUP BY period_type;"
"List transactions that were booked on one day but executed on another.","SELECT * FROM unified_transactions WHERE date(booking_date) != date(execution_timestamp);"
"What is the name of the holder for the account where the transaction 'XYZ-123' occurred?","SELECT a.account_holder_name FROM unified_accounts a JOIN unified_transactions t ON a.account_id = t.account_id_fk WHERE t.transaction_id = 'XYZ-123';"
"List all transactions from my account ending in 1234.","SELECT t.booking_date, t.description, t.amount FROM unified_transactions t JOIN unified_accounts a ON t.account_id_fk = a.account_id WHERE a.iban LIKE '%1234';"
"What's the total amount for transactions with the type code 'PMNT'?","SELECT SUM(amount) FROM unified_transactions WHERE type_code = 'PMNT';"
"Are there any transactions with a suspicious `type_code` that is not in the common list ('PMNT', 'DEB', 'CRED')?","SELECT * FROM unified_transactions WHERE type_code NOT IN ('PMNT', 'DEB', 'CRED');"
"How many times have I ordered from Thuisbezorgd on a weekend this year?","SELECT COUNT(*) as order_count FROM unified_transactions WHERE description LIKE '%Thuisbezorgd%' AND strftime('%w', booking_date) IN ('0', '6') AND strftime('%Y', booking_date) = strftime('%Y', 'now');"
"What's the highest and lowest my ING account balance was this month?","SELECT MIN(b.amount) as lowest_balance, MAX(b.amount) as highest_balance FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ING' AND b.timestamp >= date('now', 'start of month');"
"What's the total of all transactions that are not income?","SELECT SUM(amount)	FROM unified_transactions WHERE amount <= 0;"
"List my top 3 spending categories, assuming 'Albert Heijn' or 'Jumbo' are 'Groceries' and 'Netflix' or 'Spotify' are 'Subscriptions'.","SELECT CASE WHEN description LIKE '%Albert Heijn%' OR description LIKE '%Jumbo%' THEN 'Groceries' WHEN description LIKE '%Netflix%' OR description LIKE '%Spotify%' THEN 'Subscriptions' WHEN description LIKE '%restaurant%' THEN 'Dining Out' ELSE 'Other' END as category, SUM(amount) as total_spent FROM unified_transactions WHERE amount < 0 GROUP BY category ORDER BY total_spent ASC LIMIT 3;"
"Who do I owe the most money to?","SELECT counterparty_name, SUM(amount) as total_owed FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY total_owed ASC LIMIT 1;"
"What was the total outflow of money from my accounts in May 2025?","SELECT SUM(amount) FROM unified_transactions WHERE strftime('%Y-%m', booking_date) = '2025-05' AND amount < 0;"
"Do I have any accounts that are not in EUR currency?","SELECT * FROM unified_accounts WHERE currency != 'EUR';"
"Showme a list of all counterparties I have ever interacted with.","SELECT DISTINCT counterparty_name FROM unified_transactions WHERE counterparty_name IS NOT NULL AND counterparty_name != '';"
"What was my most expensive day last month?","SELECT booking_date, SUM(amount) as daily_total FROM unified_transactions WHERE amount < 0 AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') GROUP BY booking_date ORDER BY daily_total ASC LIMIT 1;"
"What is my average monthly income for this year?","SELECT SUM(amount) / CAST(strftime('%m', 'now') AS REAL) as average_monthly_income FROM unified_transactions WHERE amount > 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now');"
"Show me all payments made to someone named 'Pietersen'.","SELECT booking_date, description, counterparty_name, amount FROM unified_transactions WHERE counterparty_name LIKE '%Pietersen%' AND amount < 0 ORDER BY booking_date DESC;"
"What was the day with the highest number of transactions this month?","SELECT booking_date, COUNT(transaction_pk) as transaction_count FROM unified_transactions WHERE booking_date >= date('now', 'start of month') GROUP BY booking_date ORDER BY transaction_count DESC LIMIT 1;"
"Which of my accounts had the most transaction activity this month?","SELECT a.iban, a.source_bank, COUNT(t.transaction_pk) as transaction_count FROM unified_accounts a JOIN unified_transactions t ON a.account_id = t.account_id_fk WHERE t.booking_date >= date('now', 'start of month') GROUP BY a.account_id ORDER BY transaction_count DESC LIMIT 1;"
"List my top 3 counterparties by number of transactions, not by total amount.","SELECT counterparty_name, COUNT(transaction_pk) as num_transactions FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY num_transactions DESC LIMIT 3;"
"What's the name on the account with IBAN NL69INGB0123456789?","SELECT account_holder_name FROM unified_accounts WHERE iban = 'NL69INGB0123456789';"
"Show me my five smallest income transactions.","SELECT * FROM unified_transactions WHERE amount > 0 ORDER BY amount ASC LIMIT 5;"
"What is the total balance of all accounts that are not credit cards?","SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT b.account_id_fk, MAX(b.timestamp) AS max_timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.product_name != 'CREDITCARD' GROUP BY b.account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;"
"List transactions where the counterparty is also an ING account.","SELECT * FROM unified_transactions WHERE counterparty_iban LIKE '%INGB%';"
"Find my single largest deposit from ABN AMRO.","SELECT amount, booking_date, description FROM unified_transactions WHERE source_bank = 'ABN AMRO' AND amount > 0 ORDER BY amount DESC LIMIT 1;"
"How many unique days did I make a transaction last month?","SELECT COUNT(DISTINCT date(booking_date)) FROM unified_transactions WHERE booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day');"
"Find the transaction that happened immediately after my largest expense this month.","SELECT * FROM unified_transactions WHERE booking_date >= (SELECT booking_date FROM unified_transactions WHERE booking_date >= date('now', 'start of month') AND amount < 0 ORDER BY amount ASC LIMIT 1) ORDER BY booking_date ASC, transaction_pk ASC LIMIT 1 OFFSET 1;"
