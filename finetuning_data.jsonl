{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What are all of my accounts?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT account_holder_name, iban, source_bank FROM unified_accounts;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is my current total balance across all my accounts?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT account_id_fk, MAX(timestamp) AS max_timestamp FROM unified_balances GROUP BY account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me my last 5 expenses"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE amount < 0 ORDER BY booking_date DESC, transaction_pk DESC LIMIT 5;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How much did I spend in total last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) as total_spending FROM unified_transactions WHERE booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was my single biggest expense this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT description, amount, booking_date FROM unified_transactions WHERE booking_date >= date('now', 'start of month') AND amount < 0 ORDER BY amount ASC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List all my transactions from Albert Heijn"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE description LIKE '%Albert Heijn%' ORDER BY booking_date DESC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What income have I received this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE amount > 0 AND booking_date >= date('now', 'start of month') ORDER BY booking_date DESC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How many times did I go to a restaurant last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT COUNT(*) as visit_count FROM unified_transactions WHERE (description LIKE '%restaurant%' OR description LIKE '%eetcafe%') AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's the current balance of my ING account?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT b.amount FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ING' ORDER BY b.timestamp DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Did I spend more on dining out this month or last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT 'last_month' as period, SUM(amount) as total FROM unified_transactions WHERE (description LIKE '%restaurant%' OR description LIKE '%eetcafe%') AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') AND amount < 0 UNION ALL SELECT 'this_month' as period, SUM(amount) as total FROM unified_transactions WHERE (description LIKE '%restaurant%' OR description LIKE '%eetcafe%') AND booking_date >= date('now', 'start of month') AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me my spending from the first week of May 2025."}, {"role": "assistant", "content": "{\"sql\": \"SELECT description, amount FROM unified_transactions WHERE booking_date BETWEEN '2025-05-01' AND '2025-05-07' AND amount < 0 ORDER BY booking_date;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What were my expenses on weekends this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE strftime('%w', booking_date) IN ('0', '6') AND booking_date >= date('now', 'start of month') AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Have I received my salary yet this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE amount > 0 AND (description LIKE '%salary%' OR description LIKE '%salaris%') AND booking_date >= date('now', 'start of month') LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List my transactions from after 10 PM yesterday."}, {"role": "assistant", "content": "{\"sql\": \"SELECT execution_timestamp, description, amount FROM unified_transactions WHERE execution_timestamp >= datetime('now', '-1 day', 'start of day', '+22 hours');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How much money did I receive from the counterparty with IBAN NL12ABNA0123456789?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) as total_received FROM unified_transactions WHERE counterparty_iban = 'NL12ABNA0123456789' AND amount > 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Which 5 people or companies paid me the most money this year?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT counterparty_name, SUM(amount) as total_received FROM unified_transactions WHERE amount > 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now') AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY total_received DESC LIMIT 5;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me any payments I made to someone named 'Jansen'."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, counterparty_name, amount FROM unified_transactions WHERE counterparty_name LIKE '%Jansen%' AND amount < 0 ORDER BY booking_date DESC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was the highest and lowest my ING account balance was this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT MIN(b.amount) as lowest_balance, MAX(b.amount) as highest_balance FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ING' AND b.timestamp >= date('now', 'start of month');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Find all transactions where the description contains the word 'subscription'."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE description LIKE '%subscription%' ORDER BY booking_date DESC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List all my expenses that were larger than my average expense this month."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE amount < 0 AND booking_date >= date('now', 'start of month') AND amount < (SELECT AVG(amount) FROM unified_transactions WHERE amount < 0 AND booking_date >= date('now', 'start of month')) ORDER BY amount ASC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "On which day of the week do I tend to spend the most?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT CASE strftime('%w', booking_date) WHEN '0' THEN 'Sunday' WHEN '1' THEN 'Monday' WHEN '2' THEN 'Tuesday' WHEN '3' THEN 'Wednesday' WHEN '4' THEN 'Thursday' WHEN '5' THEN 'Friday' ELSE 'Saturday' END as day_of_week, SUM(amount) as total_spent FROM unified_transactions WHERE amount < 0 GROUP BY day_of_week ORDER BY total_spent ASC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What percentage of my income last month was spent at Albert Heijn?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT (SUM(CASE WHEN description LIKE '%Albert Heijn%' OR description LIKE '%Jumbo%' THEN amount ELSE 0 END) / SUM(CASE WHEN amount > 0 THEN amount ELSE 0 END)) * -100.0 as percentage_of_income FROM unified_transactions WHERE booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was the very last transaction on my ABN AMRO account?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT t.booking_date, t.description, t.amount FROM unified_transactions t JOIN unified_accounts a ON t.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' ORDER BY t.booking_date DESC, t.transaction_pk DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List all my bank accounts and their product names."}, {"role": "assistant", "content": "{\"sql\": \"SELECT iban, source_bank, product_name, account_holder_name FROM unified_accounts;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is the total balance of just my ABN AMRO accounts?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT b.account_id_fk, MAX(b.timestamp) AS max_timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' GROUP BY b.account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was my most expensive day last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, SUM(amount) as daily_total FROM unified_transactions WHERE amount < 0 AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') GROUP BY booking_date ORDER BY daily_total ASC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Find transactions with a blank description."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, amount, counterparty_name FROM unified_transactions WHERE description IS NULL OR description = '';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How many unique companies did I pay money to this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT COUNT(DISTINCT counterparty_name) as unique_payees FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' AND booking_date >= date('now', 'start of month');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is the transaction type code for my salary?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT type_code, description FROM unified_transactions WHERE (description LIKE '%salary%' OR description LIKE '%salaris%') AND amount > 0 LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me all transactions that are not from ABN AMRO or ING."}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE source_bank NOT IN ('ABN AMRO', 'ING');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Did I spend anything at all on the first day of this year?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT CASE WHEN EXISTS (SELECT 1 FROM unified_transactions WHERE date(booking_date) = strftime('%Y-01-01', 'now') AND amount < 0) THEN 'Yes' ELSE 'No' END as spending_exists;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Find my recent payments to a company, I think it was called 'Coolblue' or something like that."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE description LIKE '%coolblue%' ORDER BY booking_date DESC LIMIT 5;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What are the details of transaction with the id 'xyz-789'?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE transaction_id = 'xyz-789';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "I just got paid, what's my total balance now?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT account_id_fk, MAX(timestamp) AS max_timestamp FROM unified_balances GROUP BY account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is my average monthly spending for this year so far?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) / CAST(strftime('%m', 'now') AS REAL) as average_monthly_spending FROM unified_transactions WHERE amount < 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's my biggest source of income by name?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT counterparty_name, SUM(amount) as total_income FROM unified_transactions WHERE amount > 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY total_income DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List my top 3 spending categories, assuming 'Albert Heijn' or 'Jumbo' are 'Groceries' and 'Netflix' or 'Spotify' are 'Subscriptions'."}, {"role": "assistant", "content": "{\"sql\": \"SELECT CASE WHEN description LIKE '%Albert Heijn%' OR description LIKE '%Jumbo%' THEN 'Groceries' WHEN description LIKE '%Netflix%' OR description LIKE '%Spotify%' THEN 'Subscriptions' WHEN description LIKE '%restaurant%' THEN 'Dining Out' ELSE 'Other' END as category, SUM(amount) as total_spent FROM unified_transactions WHERE amount < 0 GROUP BY category ORDER BY total_spent ASC LIMIT 3;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How has my income changed month-over-month this year?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT strftime('%Y-%m', booking_date) as month, SUM(amount) as monthly_income FROM unified_transactions WHERE amount > 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now') GROUP BY month ORDER BY month;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Is my spending on transport increasing or decreasing this month compared to last?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(CASE WHEN booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') THEN amount ELSE 0 END) AS last_month, SUM(CASE WHEN booking_date >= date('now', 'start of month') THEN amount ELSE 0 END) AS this_month FROM unified_transactions WHERE (description LIKE '%NS Ticket%' OR description LIKE '%Uber%') AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was the day with the highest number of transactions this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, COUNT(transaction_pk) as transaction_count FROM unified_transactions WHERE booking_date >= date('now', 'start of month') GROUP BY booking_date ORDER BY transaction_count DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Which of my accounts currently has the highest balance?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT a.iban, a.source_bank, b.amount FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id JOIN (SELECT account_id_fk, MAX(timestamp) AS max_ts FROM unified_balances GROUP BY account_id_fk) latest ON b.account_id_fk = latest.account_id_fk AND b.timestamp = latest.max_ts ORDER BY b.amount DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Have there been any balance updates for any of my accounts today?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT a.iban, b.amount, b.timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE date(b.timestamp) = date('now') ORDER BY b.timestamp DESC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me the last 3 balance records for my ABN AMRO account."}, {"role": "assistant", "content": "{\"sql\": \"SELECT b.timestamp, b.amount FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' ORDER BY b.timestamp DESC LIMIT 3;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List everyone that I have paid but who has never paid me."}, {"role": "assistant", "content": "{\"sql\": \"SELECT DISTINCT counterparty_name FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' AND counterparty_name NOT IN (SELECT DISTINCT counterparty_name FROM unified_transactions WHERE amount > 0);\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me my largest expense that was NOT for groceries."}, {"role": "assistant", "content": "{\"sql\": \"SELECT description, amount, booking_date FROM unified_transactions WHERE amount < 0 AND description NOT LIKE '%Albert Heijn%' AND description NOT LIKE '%Jumbo%' ORDER BY amount ASC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's the total of all transactions that have an unknown type code?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) FROM unified_transactions WHERE type_code IS NULL OR type_code = '';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Do I have any bank accounts that are not from the Netherlands?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_accounts WHERE iban NOT LIKE 'NL%';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How many days have passed between my very first and very last transaction?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT julianday(MAX(booking_date)) - julianday(MIN(booking_date)) as days_between FROM unified_transactions;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Give me my total spending this month, but exclude all payments to Bol.com."}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) FROM unified_transactions WHERE amount < 0 AND booking_date >= date('now', 'start of month') AND description NOT LIKE '%Bol.com%';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is the average balance of my ABN AMRO accounts?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT AVG(t1.amount)\\tFROM unified_balances t1 JOIN (SELECT b.account_id_fk, MAX(b.timestamp) AS max_timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ABN AMRO' GROUP BY b.account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What were my total expenses in the first quarter of this year?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) as total_expenses FROM unified_transactions WHERE amount < 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now') AND strftime('%m', booking_date) IN ('01', '02', '03');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What were my expenses on weekends this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE strftime('%w', booking_date) IN ('0', '6') AND booking_date >= date('now', 'start of month') AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "how much did I spend on the 15th of last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) FROM unified_transactions WHERE date(booking_date) = date('now', 'start of month', '-1 month', '+14 days') AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me all transactions that happened on a Monday this year."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, amount FROM unified_transactions WHERE strftime('%w', booking_date) = '1' AND strftime('%Y', booking_date) = strftime('%Y', 'now');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What were my total expenses during the work week (Mon-Fri) versus the weekend last week?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT CASE WHEN strftime('%w', booking_date) IN ('0', '6') THEN 'Weekend' ELSE 'Weekday' END as period_type, SUM(amount) as total_spent FROM unified_transactions WHERE booking_date BETWEEN date('now', 'weekday 0', '-13 days') AND date('now', 'weekday 0', '-7 days') AND amount < 0 GROUP BY period_type;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List transactions that were booked on one day but executed on another."}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE date(booking_date) != date(execution_timestamp);\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is the name of the holder for the account where the transaction 'XYZ-123' occurred?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT a.account_holder_name FROM unified_accounts a JOIN unified_transactions t ON a.account_id = t.account_id_fk WHERE t.transaction_id = 'XYZ-123';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List all transactions from my account ending in 1234."}, {"role": "assistant", "content": "{\"sql\": \"SELECT t.booking_date, t.description, t.amount FROM unified_transactions t JOIN unified_accounts a ON t.account_id_fk = a.account_id WHERE a.iban LIKE '%1234';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's the total amount for transactions with the type code 'PMNT'?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) FROM unified_transactions WHERE type_code = 'PMNT';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Are there any transactions with a suspicious `type_code` that is not in the common list ('PMNT', 'DEB', 'CRED')?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE type_code NOT IN ('PMNT', 'DEB', 'CRED');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How many times have I ordered from Thuisbezorgd on a weekend this year?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT COUNT(*) as order_count FROM unified_transactions WHERE description LIKE '%Thuisbezorgd%' AND strftime('%w', booking_date) IN ('0', '6') AND strftime('%Y', booking_date) = strftime('%Y', 'now');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's the highest and lowest my ING account balance was this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT MIN(b.amount) as lowest_balance, MAX(b.amount) as highest_balance FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.source_bank = 'ING' AND b.timestamp >= date('now', 'start of month');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's the total of all transactions that are not income?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount)\\tFROM unified_transactions WHERE amount <= 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List my top 3 spending categories, assuming 'Albert Heijn' or 'Jumbo' are 'Groceries' and 'Netflix' or 'Spotify' are 'Subscriptions'."}, {"role": "assistant", "content": "{\"sql\": \"SELECT CASE WHEN description LIKE '%Albert Heijn%' OR description LIKE '%Jumbo%' THEN 'Groceries' WHEN description LIKE '%Netflix%' OR description LIKE '%Spotify%' THEN 'Subscriptions' WHEN description LIKE '%restaurant%' THEN 'Dining Out' ELSE 'Other' END as category, SUM(amount) as total_spent FROM unified_transactions WHERE amount < 0 GROUP BY category ORDER BY total_spent ASC LIMIT 3;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Who do I owe the most money to?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT counterparty_name, SUM(amount) as total_owed FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY total_owed ASC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was the total outflow of money from my accounts in May 2025?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) FROM unified_transactions WHERE strftime('%Y-%m', booking_date) = '2025-05' AND amount < 0;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Do I have any accounts that are not in EUR currency?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_accounts WHERE currency != 'EUR';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Showme a list of all counterparties I have ever interacted with."}, {"role": "assistant", "content": "{\"sql\": \"SELECT DISTINCT counterparty_name FROM unified_transactions WHERE counterparty_name IS NOT NULL AND counterparty_name != '';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was my most expensive day last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, SUM(amount) as daily_total FROM unified_transactions WHERE amount < 0 AND booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day') GROUP BY booking_date ORDER BY daily_total ASC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is my average monthly income for this year?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(amount) / CAST(strftime('%m', 'now') AS REAL) as average_monthly_income FROM unified_transactions WHERE amount > 0 AND strftime('%Y', booking_date) = strftime('%Y', 'now');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me all payments made to someone named 'Pietersen'."}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, description, counterparty_name, amount FROM unified_transactions WHERE counterparty_name LIKE '%Pietersen%' AND amount < 0 ORDER BY booking_date DESC;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What was the day with the highest number of transactions this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT booking_date, COUNT(transaction_pk) as transaction_count FROM unified_transactions WHERE booking_date >= date('now', 'start of month') GROUP BY booking_date ORDER BY transaction_count DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Which of my accounts had the most transaction activity this month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT a.iban, a.source_bank, COUNT(t.transaction_pk) as transaction_count FROM unified_accounts a JOIN unified_transactions t ON a.account_id = t.account_id_fk WHERE t.booking_date >= date('now', 'start of month') GROUP BY a.account_id ORDER BY transaction_count DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List my top 3 counterparties by number of transactions, not by total amount."}, {"role": "assistant", "content": "{\"sql\": \"SELECT counterparty_name, COUNT(transaction_pk) as num_transactions FROM unified_transactions WHERE amount < 0 AND counterparty_name IS NOT NULL AND counterparty_name != '' GROUP BY counterparty_name ORDER BY num_transactions DESC LIMIT 3;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What's the name on the account with IBAN NL69INGB0123456789?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT account_holder_name FROM unified_accounts WHERE iban = 'NL69INGB0123456789';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Show me my five smallest income transactions."}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE amount > 0 ORDER BY amount ASC LIMIT 5;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "What is the total balance of all accounts that are not credit cards?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT SUM(t1.amount) AS total_balance FROM unified_balances t1 JOIN (SELECT b.account_id_fk, MAX(b.timestamp) AS max_timestamp FROM unified_balances b JOIN unified_accounts a ON b.account_id_fk = a.account_id WHERE a.product_name != 'CREDITCARD' GROUP BY b.account_id_fk) t2 ON t1.account_id_fk = t2.account_id_fk AND t1.timestamp = t2.max_timestamp;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "List transactions where the counterparty is also an ING account."}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE counterparty_iban LIKE '%INGB%';\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Find my single largest deposit from ABN AMRO."}, {"role": "assistant", "content": "{\"sql\": \"SELECT amount, booking_date, description FROM unified_transactions WHERE source_bank = 'ABN AMRO' AND amount > 0 ORDER BY amount DESC LIMIT 1;\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "How many unique days did I make a transaction last month?"}, {"role": "assistant", "content": "{\"sql\": \"SELECT COUNT(DISTINCT date(booking_date)) FROM unified_transactions WHERE booking_date BETWEEN date('now', 'start of month', '-1 month') AND date('now', 'start of month', '-1 day');\"}"}]}
{"messages": [{"role": "system", "content": "\nYou are FinWise, an expert SQL data analyst for a personal finance app.\nYour task is to convert a user's question into a single, valid SQLite query based on the database schema provided below.\nYour ONLY output must be a JSON object with a single key \"sql\", containing the query.\n\nDatabase Schema:\nTable 'unified_accounts':\n  - account_id (TEXT)\n  - source_bank (TEXT)\n  - iban (TEXT)\n  - account_holder_name (TEXT)\n  - currency (TEXT)\n  - product_name (TEXT)\n\nTable 'unified_balances':\n  - balance_pk (INTEGER)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - timestamp (DATETIME)\n\nTable 'sqlite_sequence':\n  - name ()\n  - seq ()\n\nTable 'unified_transactions':\n  - transaction_pk (INTEGER)\n  - transaction_id (TEXT)\n  - account_id_fk (TEXT)\n  - source_bank (TEXT)\n  - amount (REAL)\n  - currency (TEXT)\n  - booking_date (DATETIME)\n  - execution_timestamp (DATETIME)\n  - description (TEXT)\n  - counterparty_name (TEXT)\n  - counterparty_iban (TEXT)\n  - type_code (TEXT)\n\n\n"}, {"role": "user", "content": "Find the transaction that happened immediately after my largest expense this month."}, {"role": "assistant", "content": "{\"sql\": \"SELECT * FROM unified_transactions WHERE booking_date >= (SELECT booking_date FROM unified_transactions WHERE booking_date >= date('now', 'start of month') AND amount < 0 ORDER BY amount ASC LIMIT 1) ORDER BY booking_date ASC, transaction_pk ASC LIMIT 1 OFFSET 1;\"}"}]}
